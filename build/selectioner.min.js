/*! Selectioner 2013-08-11 */
!function(a,b,c){var d=a.Eventable=function(){};d.prototype.on=function(a,b,c){var d=a.split(" ");return d.length>1?d.forEach(function(a){this.on(a,b,c)},this):(this._eventHandlers||(this._eventHandlers={}),this._eventHandlers[a]||(this._eventHandlers[a]=[]),this._eventHandlers[a].push({handler:b,context:c?c:this})),this},d.prototype.off=function(a,b){if(!this._eventHandlers)return this;var c=function(a,b){for(var c=0,d=this._eventHandlers[a].length;d>c;c++)this._eventHandlers[a][c].handler==b&&this._eventHandlers[a].splice(c,1)};if(a)if(a&&!b)if("function"!=typeof a){if(!this._eventHandlers[a])return this;this._eventHandlers[a].length=0}else{var d=a;for(var e in this._eventHandlers)c.call(this,e,d)}else{if(!this._eventHandlers[a])return this;c.call(this,a,b)}else delete this._eventHandlers;return this},d.prototype.trigger=function(a,b){if(this._eventHandlers){var c=this._eventHandlers[a];if(c)for(var d=this,e=0,f=c.length;f>e;e++){var g=c[e];g.handler.call(g.context,{target:d,name:a,data:b})}return this}};var e=a.Selectioner=function(a,b,d,f){if(this.settings=c.extend(!0,c.extend(!0,{},e.DefaultSettings),f),this.id=e._idSeed++,d instanceof Array||(d=[d]),this.target=a=c(a),this.display=b,this.dialogs=d,a.data("selectioner"))throw new Error("The target element has already has a Selectioner associated with it.");a.next().hasClass(this.settings.cssPrefix+"display")&&a.next().remove(),b.initialize(this);for(var g=0,h=d.length;h>g;g++)b.addDialog(d[g]);a.data("selectioner",this).css("display","none").after(this.display.element)};e.prototype=new d,e._idSeed=0,e.Core={},e.Dialog={},e.Display={},e.Extensions={},e.Popup={},e.DefaultSettings={cssPrefix:"select-",noSelectionText:"Select an option",emptyOptionText:"None",noOptionText:"No options available",noMatchesFoundText:"No matches found",typeToSearchText:"Type to search",filteredSelect:{maxItems:5,minFilterLength:1,enterOneMoreCharacterText:"Enter 1 more character",enterNumberMoreCharactersText:"Enter {{number}} more characters"}};var f=e.Core.Dialog=function(){};f.prototype.initialize=function(a){this.selectioner=a,this.validateTarget()},f.prototype.render=function(){throw new Error('The render method needs to be explicitly overridden, and must set "this.element" to a jQuery object.')},f.prototype.setPopup=function(a){this.popup=a},f.prototype.update=function(){},f.prototype.validateTarget=function(){},f.prototype.keyDown=function(a){var b={handled:!1};return 27==a.key&&(this.popup.hide(),a.preventDefault(),b.handled=!0),b},f.prototype.keyPress=function(){return{handled:!1}},f.prototype.lostFocus=function(){};var g=a.Selectioner.Popup=function(){};g.prototype.initialize=function(a){var b=this;this.selectioner=a,this.dialogs=[],this._dialogFocusIndex=null,this.element=c("<div />").addClass(this.selectioner.settings.cssPrefix+"popup").css({visibility:"hidden",position:"absolute",zIndex:"-1"}).on("mousedown focusin",function(a){a.stopPropagation()}).prop("tabindex",a.target.prop("tabindex")+1).on("focusin",function(){a.display.element.focus()}),this.update(),this.selectioner.target.on("change",function(a,c){c&&"selectioner"===c.source||!b.isShown()||(b.update(),b.reposition())}),c("body").append(this.element)},g.prototype.addDialog=function(a){if(!(a instanceof e.Core.Dialog)){var b=new e.Core.Dialog,d=c(a);b.render=function(){this.element=d},a=b}a.initialize(this.selectioner),a.setPopup(this),a.render(),this.element.append(a.element),this.dialogs.push(a);var f=this.dialogs.length-1,g=this;a.element.on("mousemove",function(){g.dialogFocusIndex(f)})},g.prototype.update=function(){for(var a=0,b=this.dialogs.length;b>a;a++)this.dialogs[a].update()},g.prototype.reposition=function(){var b=this.selectioner.display.element,d=b.offset(),e=this.element.outerWidth(!1)-this.element.width(),f=b.outerWidth(!1)-e,g=b.outerHeight(!1)+d.top,h=c(a).scrollTop(),i=this.element.outerHeight(!0),j="";c(a).height()+h<g+i?(g=d.top-i+1,h>g?(g=h,j="over"):j="above"):j="below",this.element.hasClass(j)||this.element.removeClass("below above over").addClass(j),this.element.css({width:f+"px",left:d.left+"px",top:g+"px"})},g.prototype.show=function(){if(!this.selectioner.display.isDisabled()&&!this.isShown()){var b=this;c(a).one("resize.selectioner_"+this.selectioner.id,function(){b.hide()}),this._isVisible=!0,this.update();var d=this.element.height();this.reposition(),this.element.css({visibility:"visible",zIndex:""}),d!=this.element.height()&&this.reposition(),this.selectioner.trigger("show").target.parents().add(a).on("scroll.selectioner_"+this.selectioner.id,function(){b.element.hasClass("over")||b.hide()})}},g.prototype.hide=function(){this.isShown()&&(c(a).off("resize.selectioner_{id} scroll.selectioner_{id}".replace(/\{id\}/g,this.selectioner.id)),this._isVisible=!1,this.element.css({visibility:"hidden",zIndex:"-1",top:0,left:0}),this.selectioner.trigger("hide"),this._dialogFocusIndex=null)},g.prototype.changeDialogFocus=function(a){var b=null;return b=a?this._dialogFocusIndex>0?this._dialogFocusIndex-1:this.dialogs.length-1:this._dialogFocusIndex<this.dialogs.length-1&&null!==this._dialogFocusIndex?this._dialogFocusIndex+1:0,this.dialogFocusIndex(b)},g.prototype.dialogFocusIndex=function(a){return void 0!==a&&null!==a&&this._dialogFocusIndex!==a&&(null!==this._dialogFocusIndex&&this.dialogs[this._dialogFocusIndex].lostFocus(),this._dialogFocusIndex=a),this._dialogFocusIndex},g.prototype.isShown=function(){return this._isVisible},g.prototype.keyDown=function(a){var b=null,c=38==a.key||37==a.key||8==a.key,d=this.dialogFocusIndex();null===d&&(d=this.changeDialogFocus(c));for(var e={};!e[d];)e[d]=!0,b=this.dialogs[d].keyDown(a),b.handled||(d=this.changeDialogFocus(c));return b},g.prototype.keyPress=function(a){var b=null,c=this.element.hasClass("above"),d=this.dialogFocusIndex();null===d&&(d=this.changeDialogFocus(c));for(var e={};!e[d];)e[d]=!0,b=this.dialogs[d].keyPress(a),b.handled||(d=this.changeDialogFocus(c));return b};var h=e.Core.Display=function(){};h.prototype.initialize=function(a){this.selectioner=a,this.validateTarget(),this.createDisplay(),this.createPopup()},h.prototype.isDisabled=function(){return this.selectioner.target.prop("disabled")},h.prototype.createDisplay=function(){var a=this;this.render(),this.update(),this.element.prop("tabindex",this.selectioner.target.prop("tabindex")),this.element.addClass(this.selectioner.settings.cssPrefix+"display"),this.cssClass&&this.element.addClass(this.cssClass),this.selectioner.target.closest("form").on("reset",function(){setTimeout(function(){a.update()},1)}),this.selectioner.target.on("change",function(){a.update()});var d=this.selectioner.target.attr("id");void 0!==d&&(this.labels=c(b).on("click",'label[for="'+d+'"]',function(){a.element.focus()})),this.element.on("keydown",function(b){if(27==b.which)a.popup.hide();else switch(a.popup.isShown()&&a.popup.keyDown({key:b.which,target:b.target,preventDefault:function(){b.preventDefault()}}),b.which){case 37:case 38:case 39:case 40:b.preventDefault(),a.popup.show()}}),this.element.on("keypress",function(b){a.popup.isShown()&&a.popup.keyPress({key:b.which,target:b.target,preventDefault:function(){b.preventDefault()}})})},h.prototype.createPopup=function(){var a=this,d=this.popup=new e.Popup;d.initialize(this.selectioner);var f=this.selectioner.display.element;this.element.on("focusin",function(b){var e=c(b.target);b.target===a.element||e.prop("tabindex")>-1?d.show():a.element.focus()}).on("mousedown",function(){d.isShown()?d.hide():d.show()}),c(b).on("mousedown focusin",function(a){!d.isShown()||a.target===f[0]||c.contains(f[0],a.target)||a.target===d.element[0]||c.contains(d.element[0],a.target)||d.hide()});var g=this.selectioner.settings.cssPrefix+"visible";this.selectioner.on("show",function(){f.addClass(g)}).on("hide",function(){f.removeClass(g)})},h.prototype.addDialog=function(a){this.popup.addDialog(a)},h.prototype.render=function(){throw new Error('The render method needs to be explicity overridden, and must set "this.element" to a jQuery object.')},h.prototype.update=function(){},h.prototype.getNoSelectionText=function(){return this.selectioner.target.data("placeholder")||this.selectioner.settings.noSelectionText};var i=e.Display.ListBox=function(){};i.prototype=new e.Core.Display,i.prototype.validateTarget=function(){if(!this.selectioner.target.is("select"))throw new Error("ListBox expects it's underlying target element to to be a <select /> element")},i.prototype.render=function(){this.cssClass=this.selectioner.settings.cssPrefix+"list-box",this.textElement=c("<span />").addClass(this.selectioner.settings.cssPrefix+"text");var a=c("<span />").addClass(this.selectioner.settings.cssPrefix+"button");this.element=c("<span />").append(a).append(this.textElement)},i.prototype.update=function(){var a=this.selectioner.target.find("option:selected"),b=!1;if(0===a.length||a.is('option[value=""], option:empty:not([value])')){var c=this.getNoSelectionText();c?this.textElement.text(c):this.textElement.html("&nbsp;"),b=!0}else if(a.length<=2){for(var d="",e=0,f=a.length;f>e;e++)d+=a[e].text,f-1>e&&(d+=", ");this.textElement.text(d)}else this.textElement.text("Selected "+a.length+" of "+this.selectioner.target.find("option").length);this.textElement.toggleClass("none",b)};var j=e.Dialog.SingleSelect=function(){};j.prototype=new e.Core.Dialog,j.prototype.validateTarget=function(){if(!this.selectioner.target.is("select:not([multiple])"))throw new Error('SingleSelect expects it\'s underlying target element to to be a <select /> element without a "multiple" attribute')},j.prototype.render=function(){this.element=c("<ul />"),this.bindEvents()},j.prototype.bindEvents=function(){var a=this;this.element.on("click","li a",function(){a.selectioner.target[0][this.getAttribute("data-index")].selected=!0,a.popup.hide(),a.selectioner.target.trigger("change",{source:"selectioner"})}).on("mouseenter","li",function(){a.highlight(this)})},j.prototype.isEmpty=function(){return 0===this.selectioner.target.children().length},j.prototype.update=function(){var a=this.selectioner.target.html();if(a!==this._lastRenderedTargetHtml){this._lastRenderedTargetHtml=a,this.element.empty(),this._selectableOptions=null;var b=[];if(this.isEmpty()){var d=this.selectioner.target.find('option[value=""], option:empty:not([value])').text();b.push(c("<li />").addClass("none").append(c("<span />").text(d||this.selectioner.settings.noOptionText)))}else for(var e=this.selectioner.target.children(),f=0,g=e.length;g>f;f++){var h=e[f];"OPTION"==h.tagName?b.push(this.renderOption(h)):b.push(this.renderGroup(h))}this.element.append(b)}},j.prototype.renderOption=function(a){var b,c=a.innerText||this.selectioner.settings.emptyOptionText;b=a.disabled?'<span class="disabled">'+c+"</span>":'<a href="javascript:;" data-index="'+a.index+'">'+c+"</span>";var d=null===a.value||""===a.value?"none":"";return'<li class="'+d+'">'+b+"</li>"},j.prototype.renderGroup=function(a){for(var b=['<li class="'+this.selectioner.settings.cssPrefix+'group-title"><span>'+a.label+"</span></li>"],c=a.children,d=0,e=c.length;e>d;d++)b.push(this.renderOption(c[d]));return"<li><ul>"+b.join("")+"</ul></li>"},j.prototype.getSelectableOptions=function(){return this._selectableOptions||(this._selectableOptions=this.element.find("li").filter(function(){return c(this).children("a,input,label").filter(":not(.disabled,[disabled])").length>0})),this._selectableOptions},j.prototype.highlight=function(a){var b=this,d=c(a);!d.hasClass("highlight")&&b.getSelectableOptions().filter(a).length>0&&(b.element.find("li").removeClass("highlight"),d.addClass("highlight"))},j.prototype.highlightAdjacentOption=function(a){var b=!1,d=this.getSelectableOptions();if(0===d.filter(".highlight").length)(a?d.first():d.last()).addClass("highlight"),b=!0;else for(var e=0,f=d.length;f>e;e++){var g=c(d[e]);if(g.hasClass("highlight"))if(g.removeClass("highlight"),a){if(f-1>e){c(d[e+1]).addClass("highlight"),b=!0;break}}else if(e>0){c(d[e-1]).addClass("highlight"),b=!0;break}}return b},j.prototype.scrollToHighlightedOption=function(){var a=this.getSelectableOptions().filter(".highlight");if(a.length>0){var b=a.position().top,c=this.popup.element;if(0>b)c.scrollTop(c.scrollTop()+b);else{var d=c.height();b+=a.height(),b>d&&c.scrollTop(c.scrollTop()+b-d)}}},j.prototype.selectHighlightedOption=function(){this.getSelectableOptions().filter(".highlight").find("a,label").click()},j.prototype.clearSelection=function(){this.getSelectableOptions().filter(".none:first").find("a,label").click()},j.prototype.keyDown=function(a){var b=e.Core.Dialog.prototype.keyDown.call(this,a.key);if(!b.handled)switch(a.key){case 38:this.highlightAdjacentOption(!1)&&(a.preventDefault(),b.handled=!0);break;case 40:this.highlightAdjacentOption(!0)&&(a.preventDefault(),b.handled=!0);break;case 8:a.target===this.selectioner.display.element[0]&&(this.clearSelection(),this.popup.hide(),a.preventDefault(),b.handled=!0);break;case 32:this.keyPressFilter||a.target!==this.selectioner.display.element[0]||(this.selectHighlightedOption(),a.preventDefault(),b.handled=!0);break;case 13:this.selectHighlightedOption(),a.preventDefault(),b.handled=!0}return this.scrollToHighlightedOption(),b},j.prototype.keyPress=function(a){var b={handled:!1};if(13!=a.key&&9!=a.key){var d=this;clearTimeout(this.keyPressFilterTimeout),this.keyPressFilter=(this.keyPressFilter||"")+String.fromCharCode(a.key).toUpperCase(),this.keyPressFilterTimeout=setTimeout(function(){d.keyPressFilter=""},400);for(var e=this.getSelectableOptions(),f=!1,g=0,h=e.length;h>g;g++){var i=c(e[g]);if(i.text().toUpperCase().indexOf(this.keyPressFilter)>-1){e.removeClass("highlight"),i.addClass("highlight"),f=!0;break}}f||(clearTimeout(this.keyPressFilterTimeout),this.keyPressFilter=""),a.target==this.selectioner.display.element[0]&&a.preventDefault(),b.handled=!0}return b},j.prototype.lostFocus=function(){this.element.find("li").removeClass("highlight")},c.fn.singleSelect=function(){return this.each(function(){new e(this,new e.Display.ListBox,new e.Dialog.SingleSelect)}),this};var k=e.Dialog.MultiSelect=function(){};k._inputIdIndex=0,k.prototype=new e.Dialog.SingleSelect,k.prototype.validateTarget=function(){if(!this.selectioner.target.is("select[multiple]"))throw new Error('MultiSelect expects it\'s underlying target element to to be a <select /> element with a "multiple" attribute')},k.prototype.bindEvents=function(){var a=this;this.element.on("change",'input[type="checkbox"]',function(){a.selectioner.target[0][this.getAttribute("data-index")].selected=this.checked,a.selectioner.target.trigger("change",{source:"selectioner"})}).on("change","li",function(){a.highlight(this)})},k.prototype.renderOption=function(a){var b=c("<li />"),d="MultiSelectCheckbox"+k._inputIdIndex++,e=c('<input type="checkbox" />').attr("data-index",a.index).attr("id",d);a.selected&&e.attr("checked","checked");var f=c("<label />").append(e).append(c("<span />").text(a.innerText)).attr("for",d);return this.selectioner,a.disabled&&(f.addClass("disabled"),e.prop("disabled",!0)),b.append(f),b},k.prototype.renderGroup=function(a){for(var b=this.selectioner.target,d=function(){var a=c(this).closest("ul").find("input:checkbox:not(:disabled)"),d=a.filter(":checked").length;a.prop("checked",d!=a.length||0===d).each(function(){c(this).data("option").selected=this.checked}),b.trigger("change",{source:"selectioner"})},e=c("<a />").attr("href","javascript:;").on("click",d).text(a.label),f=c("<li />").addClass(this.selectioner.settings.cssPrefix+"group-title").append(e),g=a.children,h=0,i=g.length;i>h;h++)f=f.add(this.renderOption(g[h]));var j=c("<li />").append(c("<ul >").append(f));return j},k.prototype.clearSelection=function(){this.getSelectableOptions().find("input:checkbox:checked").click()},c.fn.multiSelect=function(){return this.each(function(){new e(this,new e.Display.ListBox,new e.Dialog.MultiSelect)}),this};var l=e.Display.DateBox=function(){};l.prototype=new e.Core.Display,l.prototype.validateTarget=function(){if(!this.selectioner.target.is('input[type="date"]'))throw new Error('DateBox expects it\'s underlying target element to to be a <input type="date" /> element')},l.prototype.isReadOnly=function(){return this.selectioner.target.is("[readonly]")},l.prototype.render=function(){this.cssClass=this.selectioner.settings.cssPrefix+"date-box",this.textElement=c("<span />").addClass(this.selectioner.settings.cssPrefix+"text");var a=c("<span />").addClass(this.selectioner.settings.cssPrefix+"button");this.element=c("<span />").append(a).append(this.textElement)},l.prototype.update=function(){var a=this.selectioner.target.val();if(""!==a){var b=a.match(/(\d+)/g);this.textElement.removeClass("none").text(this.getDateText(new Date(b[0],b[1]-1,b[2])))}else this.textElement.addClass("none").text(this.selectioner.target.attr("placeholder")||"Select a date")},l.prototype.getDateText=function(b){return a.Globalize?Globalize.format(b,"d"):b.toLocaleDateString()};var m=e.Dialog.DateSelect=function(){};m.prototype=new e.Core.Dialog,m.Settings={monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"],weekStartIndex:1},m.Utility={isLeapYear:function(a){return 0===a%4&&0!==a%100||0===a%400},daysInMonth:function(a,b){return[31,m.Utility.isLeapYear(a)?29:28,31,30,31,30,31,31,30,31,30,31][b]},dateToString:function(a){if(!a)return null;var b=a.getDate().toString(),c=(a.getMonth()+1).toString(),d=a.getFullYear().toString();return 1==b.length&&(b="0"+b),1==c.length&&(c="0"+c),d+"-"+c+"-"+b},stringToTitleCase:function(a){return a.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})},buildScroller:function(a,b){var d=function(d){var e=c("<a />").attr("href","javascript:;").append(c("<span />").text(a[d]));return b===a[d]&&e.addClass("current"),e};return c("<span />").addClass("scroller").append(c("<a />").attr("href","javascript:;").addClass("up")).append(d(0).addClass("previous")).append(d(1).addClass("selected")).append(d(2).addClass("next")).append(c("<a />").attr("href","javascript:;").addClass("down"))}},m.prototype.validateTarget=function(){if(!this.selectioner.target.is('input[type="date"]'))throw new Error('DateBox expects it\'s underlying target element to to be a <input type="date" /> element')},m.prototype.render=function(){var a=this,b=function(a){a.preventDefault();var b=0;return b=a.originalEvent.wheelDelta?a.originalEvent.wheelDelta:-1*a.originalEvent.deltaY,0>b?1:-1};this.element=c("<div />").on("mousewheel wheel",function(a){a.preventDefault()}).addClass(this.selectioner.settings.cssPrefix+"date").on("mousewheel wheel",".days",function(c){a.addDays(b(c))}).on("mousewheel wheel",".months",function(c){a.addMonths(b(c))}).on("mousewheel wheel",".years",function(c){a.addYears(b(c))}).on("click",".days .previous,.days .up,.days .next,.days .down",function(){a.addDays(c(this).is(".previous, .up")?-1:1)}).on("click",".months .previous,.months .up,.months .next,.months .down",function(){a.addMonths(c(this).is(".previous, .up")?-1:1)}).on("click",".years .previous,.years .up,.years .next,.years .down",function(){a.addYears(c(this).is(".previous, .up")?-1:1)}).on("click",".selected",function(){a.setCurrentDate(a.getCurrentDate()),a.popup.hide()}).on("click",".today",function(){a.setCurrentDate(new Date),a.popup.hide()}).on("click",".clear",function(){a.setCurrentDate(null),a.popup.hide()}),this.update()},m.prototype.update=function(){var b=this.getCurrentDate(),d=b.getFullYear(),e=m.Settings.monthNames;a.Globalize&&(e=Globalize.culture().calendars.standard.months.namesAbbr);var f=b.getMonth(),g=0===f?11:f-1,h=11===f?0:f+1,i=[m.Utility.stringToTitleCase(e[g]),m.Utility.stringToTitleCase(e[f]),m.Utility.stringToTitleCase(e[h])],j=b.getDate(),k=new Date(b);k.setDate(j-1);var l=[1===j?k.getDate():j-1,j,j===m.Utility.daysInMonth(d,f)?1:j+1],n=new Date,o=c("<a />").attr("href","javascript:;").addClass("today").append(c("<span />").text("Today")),p=c("<a />").attr("href","javascript:;").addClass("clear").append(c("<span />").text("Clear"));this.element.empty().append(o);var q=new Date(1999,7,4),r=q.toLocaleDateString();a.Globalize&&(r=Globalize.format(q,"d"));var s=r.indexOf("8");-1===s&&(s=r.search(/[^\d ]/i));var t=[{index:r.indexOf("99"),element:m.Utility.buildScroller([d-1,d,d+1],n.getFullYear()).addClass("years")},{index:s,element:m.Utility.buildScroller(i,e[n.getMonth()]).addClass("months")},{index:r.indexOf("4"),element:m.Utility.buildScroller(l,n.getDate()).addClass("days")}];t.sort(function(a,b){return a.index>b.index});for(var u=0;3>u;u++)this.element.append(t[u].element);this.element.append(p)},m.prototype.addDays=function(a){if(a){var b=this.getCurrentDate();b.setDate(b.getDate()+a),this.setCurrentDate(b)}},m.prototype.addMonths=function(a){if(a){var b=this.getCurrentDate();b.setMonth(b.getMonth()+a),this.setCurrentDate(b)}},m.prototype.addYears=function(a){if(a){var b=this.getCurrentDate();b.setYear(b.getFullYear()+a),this.setCurrentDate(b)}},m.prototype.getCurrentDate=function(){var a=this.selectioner.target.val();if(""!==a){var b=a.match(/(\d+)/g);return new Date(b[0],b[1]-1,b[2])}return new Date},m.prototype.setCurrentDate=function(a){this.selectioner.target.val(m.Utility.dateToString(a)).trigger("change"),this.update()},m.prototype.keyDown=function(a){var b=e.Core.Dialog.prototype.keyDown.call(this,a.key);if(!b.handled)switch(b.handled=!0,a.key){case 38:this.addDays(-1),a.preventDefault();break;case 40:this.addDays(1),a.preventDefault();break;case 8:this.setCurrentDate(null),this.popup.hide(),a.preventDefault();break;case 32:case 13:this.setCurrentDate(this.getCurrentDate()),this.popup.hide(),a.preventDefault();break;default:b.handled=!1}return b},c.fn.dateSelect=function(){return this.each(function(){new e(this,new e.Display.DateBox,new e.Dialog.DateSelect)}),this};var n=e.Display.ComboBox=function(){};n.prototype=new e.Core.Display,n.prototype.validateTarget=function(){if(!this.selectioner.target.is("select:not([multiple])"))throw new Error('ComboBox expects it\'s underlying target element to to be a <select /> element without a "multiple" attribute')},n.prototype.render=function(){if(this.cssClass=this.selectioner.settings.cssPrefix+"combo-box",this.textElement=this.selectioner.target.next(),!this.textElement.is('input[type="text"]'))throw new Error('ComboBox expects the element to follow it\'s target <select /> to be an <input type="text" />');var a=this.getNoSelectionText();if(null!==a&&this.textElement.attr("placeholder",a),this.textElement.attr("autocomplete","off"),0===this.getEmptyOptions().length)throw new Error("ComboBox elements require an empty and value-less <option></option> in their underlying <select /> elements.");var b=this;this.textElement.addClass(this.selectioner.settings.cssPrefix+"text").on("change",function(a,c){c&&"selectioner"==c.source||b.textChanged()});var d=c("<span />").addClass(this.selectioner.settings.cssPrefix+"button");this.selectioner.on("show",function(){b.element.one("focusin",function(){b.textElement.select()})}),this.element=c("<span />").append(d).append(this.textElement)},n.prototype.textChanged=function(){var a=this,b=this.selectioner.target.find("option").filter(function(){return this.innerText.toUpperCase()===a.textElement.val().toUpperCase()});1!=b.length&&(b=this.getEmptyOptions()),b[0].selected||(b[0].selected=!0,this.selectioner.target.trigger("change",{source:"selectioner"}))},n.prototype.update=function(){var a=this.selectioner.target.find("option:selected");if(0===a.length)this.textElement.addClass("none");else{this.textElement.removeClass("none");var b=a.text();""!==b&&this.textElement.val(b).trigger("change",{source:"selectioner"})}},n.prototype.getEmptyOptions=function(){return this.selectioner.target.find('option[value=""], option:empty:not([value])')},n.prototype.getNoSelectionText=function(){return this.selectioner.target.data("placeholder")||this.textElement.attr("placeholder")||this.selectioner.settings.noSelectionText};var o=e.Dialog.ComboSelect=function(){};o.prototype=new e.Dialog.SingleSelect,o.prototype.validateTarget=function(){if(!this.selectioner.target.is("select:not([multiple])"))throw new Error('ComboSelect expects it\'s underlying target element to to be a <select /> element without a "multiple" attribute')},o.prototype.isEmpty=function(){return 0===this.selectioner.target.children().not('option[value=""], option:empty:not([value])').length},o.prototype.renderOption=function(a){return a.value?e.Dialog.SingleSelect.prototype.renderOption.call(this,a):null},c.fn.comboSelect=function(a){return this.each(function(){new e(this,new e.Display.ComboBox(a),new e.Dialog.ComboSelect)}),this};var p=e.Display.AutoComplete=function(){};p.prototype=new e.Display.ComboBox,p.prototype.render=function(){e.Display.ComboBox.prototype.render.apply(this),this.cssClass=this.selectioner.settings.cssPrefix+"auto-complete"},p.prototype.getNoSelectionText=function(){return this.selectioner.target.data("placeholder")||this.textElement.attr("placeholder")||this.selectioner.settings.typeToSearchText};var q=e.Dialog.FilteredSelect=function(){};q.prototype=new e.Dialog.SingleSelect,q.prototype.validateTarget=function(){if(!this.selectioner.target.is("select:not([multiple])"))throw new Error('ComboSelect expects it\'s underlying target element to to be a <select /> element without a "multiple" attribute')},q.prototype.render=function(){if(e.Dialog.SingleSelect.prototype.render.apply(this,arguments),this.textElement=this.selectioner.display.element.find('input[type="text"]'),0===this.textElement.length)throw new Error('FilteredSelect expects the Display to contain an <input type="text" /> element');this.update();var a=this;this.textElement.on("keyup click",function(b,c){c&&"selectioner"==c.source||27===b.which||(a.update(),a.popup.isShown()?a.popup.reposition():a.popup.show())}),this.update()},q.prototype.update=function(){var a=this.textElement.val().toLowerCase(),b=this.selectioner.settings;if(a!==this._lastFilterText){this._selectableOptions=null,this._lastFilterText=a;var c=[],d=b.filteredSelect.minFilterLength||1;if(a.length>=d){for(var e=this.selectioner.target.find("option"),f=0,g=e.length;g>f;f++){var h=e[f],i=h.innerText.toLowerCase();if(""!==i&&0===i.indexOf(a)&&(c.push(this.renderOption(h)),c.length>b.filteredSelect.maxItems))break}0===c.length&&c.push('<li class="none"><span>'+b.noMatchesFoundText+"</span></li>")}else{var j=b.filteredSelect.enterOneMoreCharacterText;d-a.length>1&&(j=b.filteredSelect.enterNumberMoreCharactersText.replace(/{{number}}/,d-a.length)),c.push('<li class="none"><span>'+j+"</span></li>")}this.element.empty().append(c)}},c.fn.autoComplete=function(){return this.each(function(){new e(this,new e.Display.AutoComplete,new e.Dialog.FilteredSelect)}),this},"function"==typeof define&&define.amd&&define("selectioner",[],function(){return e})}(this,document,jQuery);
/*
//@ sourceMappingURL=build/selectioner.min.map
*/